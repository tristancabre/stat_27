---
title: "projet_stat"
format: html
editor: visual
---

# Nettoyage de la base

```{r}
pisa<-readRDS("stu_qqq.rds")
```

## Packages nécéssaires

```{r}
library(dplyr)
library(tidyverse)
library(stringr)
```

## Colonnes à conserver

```{r}
keep <- c("CNT","ST004D01T","ST250Q01JA","ST250Q02JA","ST250Q03JA","ST250Q04JA","ST250Q05JA","ST253Q01JA","ST254Q01JA","ST254Q02JA","ST254Q03JA","ST254Q04JA","ST254Q05JA","ST254Q06JA","ST230Q01JA","ST260Q01JA","ST260Q02JA","ST260Q03JA","ST261Q01JA","ST261Q02JA","ST261Q03JA","ST261Q04JA","ST261Q05JA","ST261Q06JA","ST261Q07JA","ST261Q08JA","ST261Q09JA","ST261Q10JA","ST261Q11JA","ST267Q01JA","ST267Q02JA","ST267Q03JA","ST267Q04JA","ST267Q05JA","ST267Q06JA","ST267Q07JA","ST267Q08JA","ST034Q01JA","ST034Q02JA","ST034Q03JA","ST034Q04JA","ST034Q05JA","ST034Q06JA","ST038Q01JA","ST038Q02JA","ST038Q03JA","ST038Q04JA","ST038Q05JA","ST038Q06JA","ST038Q07JA","ST038Q08JA","ST038Q09JA","ST038Q10JA","ST038Q11JA","ST326Q01JA","ST326Q02JA","ST326Q03JA","ST326Q04JA","ST326Q05JA","ST326Q06JA","ST326Q07JA","ST326Q08JA","ST326Q09JA","ST326Q10JA","ST326Q11JA","ST326Q12JA","ST322Q01JA","ST322Q02JA","ST322Q03JA","ST322Q04JA","ST322Q05JA","ST322Q06JA","ST322Q07JA","ST307Q01JA","ST307Q02JA","ST307Q03JA","ST307Q04JA","ST307Q05JA","ST307Q06JA","ST307Q07JA","ST307Q08JA","ST307Q09JA","ST307Q10JA","ST343Q01JA","ST343Q02JA","ST343Q03JA","ST343Q04JA","ST343Q05JA","ST343Q06JA","ST343Q07JA","ST343Q08JA","ST343Q09JA","ST343Q10JA","ST311Q01JA","ST311Q02JA","ST311Q03JA","ST311Q04JA","ST311Q05JA","ST311Q06JA","ST311Q07JA","ST311Q08JA","ST311Q09JA","ST311Q10JA","ST315Q01JA","ST315Q02JA","ST315Q03JA","ST315Q04JA","ST315Q05JA","ST315Q06JA","ST315Q07JA","ST315Q08JA","ST315Q09JA","ST315Q10JA","ST305Q01JA","ST305Q02JA","ST305Q03JA","ST305Q04JA","ST305Q05JA","ST305Q06JA","ST305Q07JA","ST305Q08JA","ST305Q09JA","ST305Q10JA","ST345Q01JA","ST345Q02JA","ST345Q03JA","ST345Q04JA","ST345Q05JA","ST345Q06JA","ST345Q07JA","ST345Q08JA","ST345Q09JA","ST345Q10JA","ST313Q01JA","ST313Q02JA","ST313Q03JA","ST313Q04JA","ST313Q05JA","ST313Q06JA","ST313Q07JA","ST313Q08JA","ST313Q09JA","ST313Q10JA","ST324Q01JA","ST324Q02JA","ST324Q03JA","ST324Q04JA","ST324Q05JA","ST324Q06JA","ST324Q07JA","ST324Q08JA","ST324Q09JA","ST324Q10JA","ST324Q11JA","ST324Q12JA","ST324Q13JA","ST324Q14JA","ST016Q01JA","ST348Q01JA","ST348Q02JA","ST348Q03JA","ST348Q04JA","ST348Q05JA","ST348Q06JA","ST348Q07JA","ST348Q08JA","ST347Q01JA","ST347Q02JA","ST349Q01JA","ST350Q01JA","ST351Q01JA","ST351Q02JA","ST351Q03JA","ST351Q04JA","ST351Q05JA","ST351Q06JA","ST351Q07JA","ST351Q08JA","ST352Q01JA","ST352Q02JA","ST352Q03JA","ST352Q04JA","ST352Q05JA","ST352Q06JA","ST352Q07JA","ST352Q08JA","ST353Q01JA","ST353Q02JA","ST353Q03JA","ST353Q04JA","ST353Q05JA","ST353Q06JA","ST353Q07JA","ST353Q08JA","ST353Q01JA","ST353Q02JA","ST353Q03JA","ST353Q04JA","ST353Q05JA","ST353Q06JA","ST353Q07JA","ST353Q08JA","ST354Q01JA","ST354Q02JA","ST354Q03JA","ST354Q04JA","ST354Q05JA","ST354Q06JA","ST354Q07JA","ST354Q08JA","ST354Q09JA","ST354Q10JA","ST356Q01JA","PV1MATH","PV2MATH","PV3MATH", "PV4MATH", "PV5MATH","PV6MATH","PV7MATH","PV8MATH", "PV9MATH", "PV10MATH","PV1READ","PV2READ","PV3READ", "PV4READ", "PV5READ","PV6READ","PV7READ", "PV8READ", "PV9READ", "PV10READ","PV1SCIE","PV2SCIE","PV3SCIE", "PV4SCIE", "PV5SCIE","PV6SCIE","PV7SCIE", "PV8SCIE", "PV9SCIE", "PV10SCIE","PV1MCCR","PV2MCCR","PV3MCCR", "PV4MCCR", "PV5MCCR","PV6MCCR","PV7MCCR", "PV8MCCR", "PV9MCCR", "PV10MCCR","PV1MCQN","PV2MCQN","PV3MCQN", "PV4MCQN", "PV5MCQN","PV6MCQN","PV7MCQN", "PV8MCQN", "PV9MCQN", "PV10MCQN","PV1MCSS","PV2MCSS","PV3MCSS", "PV4MCSS", "PV5MCSS","PV6MCSS","PV7MCSS", "PV8MCSS", "PV9MCSS", "PV10MCSS","PV1MCUD","PV2MCUD","PV3MCUD", "PV4MCUD", "PV5MCUD","PV6MCUD","PV7MCUD", "PV8MCUD", "PV9MCUD", "PV10MCUD","PV1MPEM","PV2MPEM","PV3MPEM", "PV4MPEM", "PV5MPEM","PV6MPEM","PV7MPEM","PV8MPEM","PV9MPEM", "PV10MPEM","PV1MPFS","PV2MPFS","PV3MPFS", "PV4MPFS","PV5MPFS","PV6MPFS","PV7MPFS", "PV8MPFS", "PV9MPFS", "PV10MPFS","PV1MPIN","PV2MPIN","PV3MPIN","PV4MPIN", "PV5MPIN","PV6MPIN","PV7MPIN","PV8MPIN","PV9MPIN","PV10MPIN",
          "PV1MPRE","PV2MPRE","PV3MPRE", "PV4MPRE", "PV5MPRE","PV6MPRE","PV7MPRE", "PV8MPRE", "PV9MPRE", "PV10MPRE", "ST016Q01NA")

```

```{r}
pisa2 <- pisa[,(names(pisa) %in% keep)]
```

## regroupement de colonnes

```{r}
library(dplyr)
```

```{r}
pisa3 <- pisa2
```

```{r}
pisa3 <- pisa3 %>%
  mutate(MATH = (PV1MATH + PV2MATH + PV3MATH + PV4MATH + PV5MATH + pisa3$PV6MATH +
                   PV7MATH + PV8MATH + PV9MATH + PV10MATH)/10 )
```

```{r}
pisa3 <- pisa3 %>%
  select(-PV1MATH, -PV2MATH, -PV3MATH, -PV4MATH, -PV5MATH, -PV6MATH, -PV7MATH, -PV8MATH, -PV9MATH, -PV10MATH)
```

```{r}
pisa3 <- pisa3 %>%
  mutate(
    SCIE = (PV1SCIE + PV2SCIE + PV3SCIE + PV4SCIE + PV5SCIE +
            PV6SCIE + PV7SCIE + PV8SCIE + PV9SCIE + PV10SCIE) / 10
  )

```

```{r}
pisa3 <- pisa3 %>%
  select(-PV1SCIE, -PV2SCIE, -PV3SCIE, -PV4SCIE, -PV5SCIE,
         -PV6SCIE, -PV7SCIE, -PV8SCIE, -PV9SCIE, -PV10SCIE)

```

```{r}
pisa3 <- pisa3 %>%
  mutate(
    READ = (PV1READ + PV2READ + PV3READ + PV4READ + PV5READ +
            PV6READ + PV7READ + PV8READ + PV9READ + PV10READ) / 10
  )

```

```{r}
pisa3 <- pisa3 %>%
  select(-PV1READ, -PV2READ, -PV3READ, -PV4READ, -PV5READ,
         -PV6READ, -PV7READ, -PV8READ, -PV9READ, -PV10READ)

```

```{r}
summary(pisa3$READ)
```

```{r}
pisa3 <- pisa3 %>%
  mutate(
    MCQN = (PV1MCQN + PV2MCQN + PV3MCQN + PV4MCQN + PV5MCQN +
            PV6MCQN + PV7MCQN + PV8MCQN + PV9MCQN + PV10MCQN) / 10
  )

```

```{r}
pisa3 <- pisa3 %>%
  select(-PV1MCQN, -PV2MCQN, -PV3MCQN, -PV4MCQN, -PV5MCQN,
         -PV6MCQN, -PV7MCQN, -PV8MCQN, -PV9MCQN, -PV10MCQN)

```

```{r}
pisa3 <- pisa3 %>%
  mutate(
    MCSS = (PV1MCSS + PV2MCSS + PV3MCSS + PV4MCSS + PV5MCSS +
            PV6MCSS + PV7MCSS + PV8MCSS + PV9MCSS + PV10MCSS) / 10
  )

```

```{r}
pisa3 <- pisa3 %>%
  select(-PV1MCSS, -PV2MCSS, -PV3MCSS, -PV4MCSS, -PV5MCSS,
         -PV6MCSS, -PV7MCSS, -PV8MCSS, -PV9MCSS, -PV10MCSS)

```

```{r}
pisa3 <- pisa3 %>%
  mutate(
    MCUD = (PV1MCUD + PV2MCUD + PV3MCUD + PV4MCUD + PV5MCUD +
            PV6MCUD + PV7MCUD + PV8MCUD + PV9MCUD + PV10MCUD) / 10
  )

```

```{r}
pisa3 <- pisa3 %>%
  select(-PV1MCUD, -PV2MCUD, -PV3MCUD, -PV4MCUD, -PV5MCUD,
         -PV6MCUD, -PV7MCUD, -PV8MCUD, -PV9MCUD, -PV10MCUD)

```

```{r}
pisa3 <- pisa3 %>%
  mutate(
    MPEM = (PV1MPEM + PV2MPEM + PV3MPEM + PV4MPEM + PV5MPEM +
            PV6MPEM + PV7MPEM + PV8MPEM + PV9MPEM + PV10MPEM) / 10
  )

```

```{r}
pisa3 <- pisa3 %>%
  select(-PV1MPEM, -PV2MPEM, -PV3MPEM, -PV4MPEM, -PV5MPEM,
         -PV6MPEM, -PV7MPEM, -PV8MPEM, -PV9MPEM, -PV10MPEM)

```

```{r}
pisa3 <- pisa3 %>%
  mutate(
    MPFS = (PV1MPFS + PV2MPFS + PV3MPFS + PV4MPFS + PV5MPFS +
            PV6MPFS + PV7MPFS + PV8MPFS + PV9MPFS + PV10MPFS) / 10
  )

```

```{r}
pisa3 <- pisa3 %>%
  select(-PV1MPFS, -PV2MPFS, -PV3MPFS, -PV4MPFS, -PV5MPFS,
         -PV6MPFS, -PV7MPFS, -PV8MPFS, -PV9MPFS, -PV10MPFS)

```

```{r}
pisa3 <- pisa3 %>%
  mutate(
    MPIN = (PV1MPIN + PV2MPIN + PV3MPIN + PV4MPIN + PV5MPIN +
            PV6MPIN + PV7MPIN + PV8MPIN + PV9MPIN + PV10MPIN) / 10
  )
```

```{r}
pisa3 <- pisa3 %>%
  select(-PV1MPIN, -PV2MPIN, -PV3MPIN, -PV4MPIN, -PV5MPIN,
         -PV6MPIN, -PV7MPIN, -PV8MPIN, -PV9MPIN, -PV10MPIN)

```

```{r}
pisa3 <- pisa3 %>%
  mutate(
    MPRE = (PV1MPRE + PV2MPRE + PV3MPRE + PV4MPRE + PV5MPRE +
            PV6MPRE + PV7MPRE + PV8MPRE + PV9MPRE + PV10MPRE) / 10
  )
pisa3 <- pisa3 %>%
  select(-PV1MPRE, -PV2MPRE, -PV3MPRE, -PV4MPRE, -PV5MPRE,
         -PV6MPRE, -PV7MPRE, -PV8MPRE, -PV9MPRE, -PV10MPRE)

```

```{r}
pisa3 <- pisa3 %>%
  mutate(
    MCCR = (PV1MCCR + PV2MCCR + PV3MCCR + PV4MCCR + PV5MCCR +
            PV6MCCR + PV7MCCR + PV8MCCR + PV9MCCR + PV10MCCR) / 10
  )
```

```{r}
pisa3 <- pisa3 %>%
  select(-PV1MCCR, -PV2MCCR, -PV3MCCR, -PV4MCCR, -PV5MCCR,
         -PV6MCCR, -PV7MCCR, -PV8MCCR, -PV9MCCR, -PV10MCCR)

```

## Nouveau fichier

```{r}

saveRDS(pisa3, file = "pisa3.rds")

```
